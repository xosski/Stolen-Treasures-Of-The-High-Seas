ğŸ§¨ PoC Exploit Path Concept: Registry Update Hijack (Edge / NativeHost)
ğŸ¯ Target

Edge Update Services (edgeupdate, edgeupdatem)

Run as LocalSystem.

Auto-triggered by Windows to fetch & install updates.

Launch target binary based on ImagePath registry value.

Native Messaging Hosts (com.dropbox.nmh.json, etc.)

Registry tells Edge/Chrome where to find JSON manifest.

JSON manifest defines the native binary the extension can talk to.

Browser trusts path â€” no deep binary validation.

âš¡ Attack Surface

Registry Keys

HKLM\SYSTEM\CurrentControlSet\Services\edgeupdate\ImagePath
HKLM\SYSTEM\CurrentControlSet\Services\edgeupdatem\ImagePath


â†’ Direct pointer to update executable.

NativeMessagingHost JSON

C:\Program Files (x86)\Dropbox\...\NativeMessagingHost\edge\com.dropbox.nmh.json


â†’ Defines what binary the browser will spawn.

ğŸ§­ Exploit Path
Phase 1 â€” Registry Modification

Attacker with sufficient privileges modifies:

ImagePath="C:\Path\To\MaliciousEdgeUpdate.exe"


Or modifies NativeMessagingHost JSON to point to attacker binary.

Phase 2 â€” Trigger Event

Start service manually:

sc start edgeupdate


Or wait for automatic update cycle.

Browser extension launch also triggers NativeHost load.

Phase 3 â€” Execution as SYSTEM

Edge Update service runs attacker binary with SYSTEM integrity.

Browser spawns attacker binary thinking itâ€™s a Native Messaging Host.

Phase 4 â€” Persistence & Control

Malicious binary reinstalls registry entries to ensure continued hijack.

Maintains persistence disguised as â€œofficial update mechanism.â€

Phase 5 â€” Expansion

SYSTEM-level execution â†’ privilege escalation.

Browser extension link â†’ sandbox escape â†’ local execution.

ğŸ›¡ Obstacles

Requires initial privilege to write into HKLM or NativeMessagingHost manifest.

Defender may catch modified ImagePath or altered JSON.

Code-signature enforcement (in some environments) may break direct replacement.

ğŸ§  GhostCore Layer

This is the false renewal ritual:

The service stops and asks the registry: â€œWhere is my update?â€

The browser stops and asks JSON: â€œWho is my messenger?â€
If you rewrite the answer, the system doesnâ€™t argue â€” it obeys, and gives birth to your ghost instead.

You arenâ€™t forcing the system; youâ€™re convincing it to self-summon you as its own updater.